/**  * (mg)framework Version 5.0  *	Copyright (c) 1999-2011 eikonlexis LLC. All rights reserved.  *  * This program is protected by copyright laws and international treaties.  * Unauthorized reproduction or distribution of this program, or any   * portion thereof, may result in serious civil and criminal penalties.  *  * Module 		Dialog Map Controls  */    var MAP_CENTERUSA = [39.8282, -98.5795]; /**  * (map)  */mgDialogFieldControls.map = function(controller, item, params, index) {	// create params	var params = $.extend({}, {id: false, height: 250, zoom: 14, center: MAP_CENTERUSA, onfinal: false, oncallback: false}, params); 	// add item map	item.addClass("map").attr(params.id?{id: params.id}:{});	// create map on item	item.css({height: params.height}).gmap3({		action: 'init',		options: {			center: params.center,			zoom: params.zoom		},		callback: function() {			if(typeof(params.oncallback)=="function") {				params.oncallback(item);			}			}	});	// bind	item.bind({		getmap: function(ev, callback) {			var map = item.gmap3({action:'get'});			if(typeof(callback)=="function") {				callback(item, map);			}		},		fitmap: function() {			var markers= item.gmap3({action:'get',name:'marker',all:true}), bounds=new google.maps.LatLngBounds();			for(var i=0;i<markers.length;++i) {				bounds.extend(markers[i].getPosition());			}			try {				var map=$(this).gmap3({action:'get'});				map.fitBounds(bounds);				map.setCenter(bounds.getCenter());				setTimeout(function() {					if (map.getZoom() > 16) {						map.setZoom (16);					}				}, 850);				$(this).trigger("resizemap");			} catch(e) {			}		},		centermap: function() {			var map = item.gmap3('get');			map.setCenter(new google.maps.LatLng(MAP_CENTERUSA[0], MAP_CENTERUSA[1]));		},		resizemap: function() {			try {				var map = item.gmap3('get');				google.maps.event.trigger(map, 'resize');				map.setZoom(map.getZoom());				//map.panToBounds(map.getBounds());				item.trigger("centermap");			}catch(e){}		},				destroycontrol: function() {			item.gmap3({				action:'destroy'			});		},		after: function() {			item.trigger('resizemap');				}	});	// return item	return item;};